Git — это фундаментальный инструмент для любого разработчика и DevOps-инженера. 

### **Основы систем контроля версий. Знакомство с Git**

---

## **◦ Основы систем контроля версий**

**Система контроля версий (Version Control System, VCS)** — это программное обеспечение, которое помогает отслеживать изменения в файлах (чаще всего в исходном коде) с течением времени. Представьте себе "машину времени" для вашего проекта.

**Зачем это нужно?**
*   **Хранение истории:** Вы можете увидеть, кто, когда и какие изменения внёс в код.
*   **Откат изменений:** Если новая функция сломала всё, вы можете легко вернуться к рабочей версии.
*   **Командная работа:** Несколько человек могут работать над одним проектом, не мешая друг другу.
*   **Ветвление и слияние:** Вы можете создавать изолированные "песочницы" (ветки) для разработки новой функционала, а затем безопасно объединять их с основным кодом.
*   **Резервное копирование:** Репозиторий (хранилище кода) является де-факто резервной копией.

**Типы VCS:**
1.  **Локальные (Local VCS):** История изменений хранится на локальном компьютере (например, RCS). Не подходит для командной работы.
2.  **Централизованные (Centralized VCS, CVCS):** Есть один главный сервер, который хранит всю историю файлов. Разработчики "забирают" файлы с него и "возвращают" обратно (например, Subversion, CVS). Недостаток: единая точка отказа (если сервер упадёт, никто не может работать).
3.  **Распределённые (Distributed VCS, DVCS):** Каждый разработчик имеет на своём компьютере **полную копию** репозитория со всей его историей. Это позволяет работать офлайн и предоставляет множество копий для резервирования. **Git и Mercurial** — яркие примеры.

---

## **◦ Работа с проектами в Git**

Чтобы начать работу с Git, ваш проект нужно инициализировать или клонировать.

*   **`git init`** — создаёт новый локальный репозиторий в текущей папке. Появится скрытая папка `.git`, где Git будет хранить всю свою служебную информацию и историю.
*   **`git clone <url-репозитория>`** — создаёт локальную копию удалённого репозитория (например, с GitHub, GitLab или Bitbucket). Это самый частый способ начать работу с существующим проектом.
  *   Пример: `git clone https://github.com/user/project.git`

**Базовый рабочий цикл:**
1.  Вы вносите изменения в файлы в вашей рабочей директории.
2.  Вы подготавливаете файлы, добавляя их в **область подготовленных файлов (Staging Area)** командой `git add`. Это позволяет вам контролировать, какие именно изменения попадут в следующий коммит.
3.  Вы фиксируете изменения командой `git commit`. Это навсегда сохраняет снимок подготовленных файлов в вашей локальной истории.

---

## **◦ Архитектура и объекты Git**

Понимание внутреннего устройства Git помогает не просто заучивать команды, а понимать, что происходит "под капотом".

**Три основных состояния файла в Git:**
1.  **Modified (изменён):** Файл был изменён, но изменения ещё не зафиксированы в Git.
2.  **Staged (подготовлен):** Изменённый файл был отмечен для включения в следующий коммит.
3.  **Committed (зафиксирован):** Данные безопасно сохранены в вашей локальной базе данных.

**Три основные области Git:**
*   **Рабочая директория (Working Directory):** Папка на вашем компьютере, где вы непосредственно работаете с файлами.
*   **Область подготовленных файлов (Staging Area / Index):** Промежуточная область, где вы собираете "комплект" изменений для следующего коммита.
*   **Репозиторий Git (Git Directory / Repository):** Папка `.git`, где хранятся все коммиты и метаданные.

**Основные объекты Git:**
*   **BLOB (Binary Large Object):** Хранит содержимое одного файла.
*   **Tree (Дерево):** Похоже на директорию файловой системы. Хранит ссылки на BLOB-объекты (файлы) и другие tree-объекты (поддиректории).
*   **Commit (Коммит):** Снимок состояния вашего проекта в определённый момент времени. Содержит:
    *   Хэш предыдущего коммита (родителя).
    *   Ссылку на tree-объект, который представляет состояние рабочей директории на момент коммита.
    *   Автора, дату и сообщение коммита.
*   **Tag (Тег):** Постоянная метка для определённого коммита (часто используется для отметки версий, например, `v1.0.0`).

**Важный момент:** Каждый объект в Git идентифицируется своим **SHA-1 хэшем** — уникальным 40-символьным идентификатором, вычисляемым на основе его содержимого.

---

## **◦ Конфигурация Git**

Перед началом работы Git нужно представиться. Настройки хранятся в файлах и могут быть на трёх уровнях:

1.  **`--system`** (системные): Для всех пользователей на компьютере. Файл: `/etc/gitconfig`.
2.  **`--global`** (глобальные): Для вашего пользователя. Файл: `~/.gitconfig` или `~/.config/git/config`.
3.  **`--local`** (локальные): Конкретно для текущего репозитория. Файл: `.git/config` в репозитории. **Имеет наивысший приоритет.**

**Основные команды для настройки:**
```bash
# Установка имени и email (ОБЯЗАТЕЛЬНО СДЕЛАТЬ ПЕРВЫМ ДЕЛОМ)
git config --global user.name "Ваше Имя"
git config --global user.email "your.email@example.com"

# Установка редактора по умолчанию (например, VS Code)
git config --global core.editor "code --wait"

# Просмотр всех настроек
git config --list

# Просмотр конкретной настройки
git config user.name
```

---

## **◦ Основные команды Git**

| Команда | Описание |
| :--- | :--- |
| `git status` | Показывает состояние рабочей директории и staging area: какие файлы изменены, но не подготовлены; какие подготовлены, но не закоммичены. |
| `git add <file>` | Добавляет конкретный файл в staging area. |
| `git add .` | Добавляет все изменённые и новые файлы в текущей директории и поддиректориях в staging area. |
| `git commit -m "Сообщение"` | Фиксирует подготовленные изменения, создавая новый коммит с заданным сообщением. |
| `git log` | Показывает историю коммитов в текущей ветке. |
| `git log --oneline` | Показывает компактную историю (хэш и сообщение). |
| `git diff` | Показывает разницу между рабочей директорией и staging area. |
| `git diff --staged` | Показывает разницу между staging area и последним коммитом. |
| `git restore <file>` | Отменяет изменения в файле в рабочей директории (возвращает к состоянию последнего коммита). |
| `git restore --staged <file>` | Убирает файл из staging area (отменяет `git add`), но сохраняет изменения в рабочей директории. |

---

## **◦ Работа с ветками и слияние**

**Ветка (Branch)** — это подвижный указатель на один из коммитов. По умолчанию в Git создаётся ветка с именем `main` (ранее `master`).

**Зачем нужны ветки?**
Представьте, что вы работаете над новой функцией, которая займёт 2 недели. Вместо того чтобы коммитить незаконченный код в основную ветку, вы создаёте новую ветку. Это изолированная среда, где вы можете спокойно экспериментировать, не затрагивая стабильную основную версию.

| Команда | Описание |
| :--- | :--- |
| `git branch` | Показывает список всех локальных веток. Текущая ветка помечена `*`. |
| `git branch <name>` | Создаёт новую ветку с именем `<name>`. |
| `git checkout <name>` | Переключается на ветку `<name>`. |
| `git switch <name>` | **Более новая и интуитивная команда** для переключения на ветку. |
| `git checkout -b <name>` | Создаёт новую ветку и сразу переключается на неё (удобный алиас). |
| `git switch -c <name>` | Аналог `checkout -b` для команды `switch`. |
| `git merge <name>` | Вливает изменения из ветки `<name>` в **текущую** ветку. |

**Типы слияния (Merge):**
1.  **Fast-Forward:** Если текущая ветка не отходила от той, в которую вы сливаете, Git просто перемещает указатель вперёд. История остаётся линейной.
2.  **Recursive (3-way merge):** Если в обеих ветках были свои коммиты, Git создаёт **коммит слияния**, у которого два родителя. История становится нелинейной.

**Конфликты слияния:** Возникают, когда Git не может автоматически разрешить разницу в одном и том же месте одного и того же файла в двух сливаемых ветках. Вам придётся **вручную** отредактировать файл, убрав маркеры конфликта (`<<<<<<<`, `=======`, `>>>>>>>`), чтобы решить, какой код останется, а затем сделать коммит.

---

## **◦ Работа с историей**

История в Git — это цепочка коммитов. Умение работать с ней — ключевой навык.

| Команда | Описание |
| :--- | :--- |
| `git log` | Основной инструмент. Показывает историю. |
| `git log --oneline --graph --all` | Показывает компактную, наглядную историю всех веток с графом. |
| `git show <commit-hash>` | Показывает информацию о конкретном коммите, включая разницу (diff). |
| `git commit --amend` | **"Исправляет" последний коммит.** Позволяет изменить его сообщение или добавить забытые файлы (если вы сделали `git add` после коммита). **Внимание:** Не используйте для уже отправленных в общий репозиторий коммитов! |
| `git reset <commit-hash>` | Сбрасывает текущую ветку к указанному коммиту. Бывает трёх типов: |
| `git reset --soft <commit>` | Откатывает историю, но оставляет изменения в staging area. |
| `git reset --mixed <commit>` | **(По умолчанию)** Откатывает историю, оставляет изменения в рабочей директории, но НЕ в staging area. |
| `git reset --hard <commit>` | **ОПАСНО!** Полностью откатывает и историю, и рабочую директорию к состоянию на момент указанного коммита. Все незакоммиченные изменения будут безвозвратно удалены. |
| `git revert <commit-hash>` | **Безопасная альтернатива `reset` для общих веток.** Создаёт *новый коммит*, который отменяет изменения, внесённые указанным коммитом. История не переписывается. |

**Важное предупреждение:** Команды, которые **переписывают историю** (`amend`, `reset`), опасны для коммитов, которые уже были отправлены в общий репозиторий. Они вызывают рассинхронизацию у других разработчиков. Для исправления удалённых коммитов всегда используйте `revert`.



---

## **🐧 УСТАНОВКА GIT НА UBUNTU**

### **Способ 1: Установка из официальных репозиториев (рекомендуется)**

```bash
# Обновление списка пакетов
sudo apt update

# Установка Git
sudo apt install git

# Проверка установки
git --version
```

### **Способ 2: Установка последней версии из PPA**

```bash
# Добавление PPA репозитория
sudo add-apt-repository ppa:git-core/ppa

# Обновление и установка
sudo apt update
sudo apt install git

# Проверка
git --version
```

### **Настройка Git после установки**

```bash
# Настройка имени пользователя (замените на свое)
git config --global user.name "Ваше Имя"

# Настройка email (должен совпадать с GitHub)
git config --global user.email "your.email@example.com"

# Настройка редактора по умолчанию
git config --global core.editor nano

# Просмотр всех настроек
git config --list
```

---

## **🪟 УСТАНОВКА GIT НА WINDOWS**

### **Способ 1: Установка официального Git for Windows**

1. **Скачайте установщик:**
   - Перейдите на [git-scm.com](https://git-scm.com/)
   - Нажмите "Download for Windows"

2. **Запустите установщик и следуйте шагам:**

   **Шаг 1: Лицензионное соглашение**
   - Нажмите "Next"

   **Шаг 2: Выбор папки установки**
   - Оставьте по умолчанию или выберите свою папку
   - Нажмите "Next"

   **Шаг 3: Выбор компонентов**
   - ✅ Git Bash Here
   - ✅ Git GUI Here  
   - ✅ Associate .git* configuration files with the default text editor
   - ✅ Associate .sh files to be run with Bash
   - Нажмите "Next"

   **Шаг 4: Выбор редактора по умолчанию**
   - Рекомендуется: "Use Visual Studio Code as Git's default editor"
   - Или выберите другой редактор
   - Нажмите "Next"

   **Шаг 5: Настройка имени основной ветки**
   - Выберите: "Let Git decide" (рекомендуется)
   - Нажмите "Next"

   **Шаг 6: Настройка PATH**
   - Выберите: "Git from the command line and also from 3rd-party software"
   - Нажмите "Next"

   **Шаг 7: Настройка SSH**
   - Выберите: "Use OpenSSH"
   - Нажмите "Next"

   **Шаг 8: Настройка HTTPS транспорта**
   - Выберите: "Use the OpenSSL library"
   - Нажмите "Next"

   **Шаг 9: Настройка окончаний строк**
   - Выберите: "Checkout Windows-style, commit Unix-style line endings"
   - Нажмите "Next"

   **Шаг 10: Настройка эмулятора терминала**
   - Выберите: "Use MinTTY"
   - Нажмите "Next"

   **Шаг 11: Дополнительные опции**
   - ✅ Enable file system caching
   - ✅ Enable Git Credential Manager
   - Нажмите "Install"

3. **Завершение установки**
   - Дождитесь завершения установки
   - Нажмите "Finish"

### **Способ 2: Установка через Chocolatey**

```powershell
# Установка Chocolatey (если не установлен)
Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))

# Установка Git
choco install git -y

# Проверка установки
git --version
```

### **Настройка Git на Windows**

```bash
# Откройте Git Bash или Command Prompt

# Настройка имени пользователя
git config --global user.name "Ваше Имя"

# Настройка email
git config --global user.email "your.email@example.com"

# Настройка редактора (если используете VS Code)
git config --global core.editor "code --wait"

# Включение цветного вывода
git config --global color.ui auto

# Проверка настроек
git config --list
```

---

## **🔑 НАСТРОЙКА АУТЕНТИФИКАЦИИ С GITHUB**

### **Способ 1: HTTPS с Personal Access Token (рекомендуется для начинающих)**

1. **Создайте Personal Access Token на GitHub:**
   - Зайдите на GitHub.com → Settings → Developer settings → Personal access tokens → Tokens (classic)
   - Нажмите "Generate new token"
   - Выберите срок действия и права (репозитории)
   - Скопируйте токен (он покажется только один раз!)

2. **Использование токена:**
   ```bash
   # При клонировании или пуше Git запросит логин и пароль
   # В качестве пароля используйте токен
   git clone https://github.com/username/repository.git
   ```

### **Способ 2: SSH ключи (более безопасно)**

#### **Создание SSH ключа:**

**На Ubuntu/Windows:**
```bash
# Генерация SSH ключа (замените email на свой)
ssh-keygen -t ed25519 -C "your.email@example.com"

# Или для старых систем:
ssh-keygen -t rsa -b 4096 -C "your.email@example.com"

# На вопрос о месте сохранения нажмите Enter
# На вопрос о парольной фразе введите или оставьте пустой
```

#### **Добавление ключа в SSH-агент:**

**На Ubuntu:**
```bash
# Запуск SSH-агента
eval "$(ssh-agent -s)"

# Добавление приватного ключа
ssh-add ~/.ssh/id_ed25519
```

**На Windows:**
```bash
# Запуск SSH-агента
eval $(ssh-agent -s)

# Добавление ключа
ssh-add ~/.ssh/id_ed25519
```

#### **Добавление ключа в GitHub:**

1. **Скопируйте публичный ключ:**
   ```bash
   # Показать и скопировать ключ
   cat ~/.ssh/id_ed25519.pub
   ```

2. **Добавьте ключ в GitHub:**
   - GitHub.com → Settings → SSH and GPG keys → New SSH key
   - Вставьте ключ в поле "Key"
   - Добавьте название и сохраните

3. **Проверка подключения:**
   ```bash
   ssh -T git@github.com
   # Должно появиться: "Hi username! You've successfully authenticated..."
   ```

---

## **🚀 ПЕРВОНАЧАЛЬНАЯ НАСТРОЙКА ПРОЕКТА**

### **Создание нового репозитория:**

```bash
# Создание папки проекта
mkdir my-project
cd my-project

# Инициализация Git репозитория
git init

# Создание README файла
echo "# My Project" > README.md

# Добавление файлов в staging area
git add .

# Первый коммит
git commit -m "Initial commit"

# Добавление удаленного репозитория (создайте на GitHub сначала)
git remote add origin https://github.com/username/repository.git

# Отправка кода на GitHub
git push -u origin main
```

### **Клонирование существующего репозитория:**

```bash
# Клонирование по HTTPS
git clone https://github.com/username/repository.git

# Клонирование по SSH
git clone git@github.com:username/repository.git

# Переход в папку проекта
cd repository
```

---

## **🔧 ПОЛЕЗНЫЕ КОМАНДЫ ДЛЯ РАБОТЫ**

### **Базовые команды:**
```bash
# Проверка статуса
git status

# Просмотр истории коммитов
git log
git log --oneline

# Просмотр изменений
git diff

# Добавление всех изменений
git add .

# Коммит изменений
git commit -m "Описание изменений"

# Отправка на GitHub
git push

# Получение обновлений
git pull
```

### **Настройка игнорирования файлов:**
```bash
# Создание .gitignore файла
touch .gitignore

# Пример содержимого .gitignore
echo "node_modules/
.env
*.log
.DS_Store" > .gitignore
```

---

## **🎯 ПРОВЕРКА УСТАНОВКИ**

### **Финальная проверка:**

```bash
# Проверка версии Git
git --version

# Проверка настроек
git config --list

# Проверка подключения к GitHub (для SSH)
ssh -T git@github.com

# Тестовый репозиторий
git clone https://github.com/octocat/Spoon-Knife.git
cd Spoon-Knife
ls -la
```

---

## **⚠️ РЕШЕНИЕ ЧАСТЫХ ПРОБЛЕМ**

### **Проблема: "Permission denied" при push**
**Решение:** Настройте аутентификацию через SSH или используйте Personal Access Token

### **Проблема: "Could not resolve hostname"**
**Решение:** Проверьте интернет-соединение и правильность URL репозитория

### **Проблема: "Authentication failed"**
**Решение:** Обновите кэш учетных данных:
```bash
# Windows
git credential-manager reject https://github.com

# Linux
git config --global --unset credential.helper
```

### **Проблема: Неправильная кодировка**
**Решение:** Настройте кодировку:
```bash
git config --global core.quotepath off
git config --global i18n.commitencoding utf-8
```

---

## **💡 СОВЕТЫ ДЛЯ НАЧИНАЮЩИХ**

1. **Всегда делайте `git status`** перед коммитом
2. **Пишите понятные сообщения коммитов**
3. **Чаще делайте коммиты** - лучше много маленьких, чем один большой
4. **Используйте `.gitignore`** для исключения ненужных файлов
5. **Освойте ветвление (branches)** для работы над разными функциями

Теперь вы готовы к работе с Git и GitHub! 🚀